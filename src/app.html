<!doctype html>
<!-- Use a valid BCP47 language tag here. During builds/SSR this can be templated if you need per-guild localization. -->
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<link rel="icon" href="/favicon.ico" sizes="any" />
		<link rel="icon" href="/favicon-32.png" type="image/png" sizes="32x32" />
		<link rel="icon" href="/favicon-16.png" type="image/png" sizes="16x16" />
		<!-- Preconnect to critical third-party origins -->
		<!-- Discord CDN preconnect is added conditionally in +layout.svelte when authenticated -->
		<link rel="preconnect" href="https://images.unsplash.com" />
		<link rel="dns-prefetch" href="https://images.unsplash.com" />
		<!--
		  Preload your LCP image here. Replace the href with the actual LCP image path.
		  Example:
		  <link rel="preload" as="image" href="/images/hero-lcp.webp">
		-->
		<!-- <link rel="preload" as="image" href="/path/to/lcp-image.webp"> -->
		<link
			rel="preload"
			href="/fonts/inter-v20-latin-regular.woff2"
			as="font"
			type="font/woff2"
			crossorigin
		/>
		<link
			rel="preload"
			href="/fonts/space-grotesk-v22-latin-regular.woff2"
			as="font"
			type="font/woff2"
			crossorigin
		/>
		<meta
			name="description"
			content="Track disc golf scores, view leaderboards, and compete with your club using Frolf Bot."
		/>
		<meta property="og:type" content="website" />
		<meta property="og:site_name" content="Frolf Bot" />
		<meta property="og:image" content="/og-image.jpg" />
		<meta name="theme-color" content="#007474" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<link rel="apple-touch-icon" href="/icons/icon-192.png" />

		<!--
		  Small synchronous theme initializer that runs before the app paints.
		  It sets the `.dark` class on <html> based on a stored preference or
		  the user's OS preference. This enables Tailwind's class-based dark
		  mode and ensures colors are correct on first render (avoids flash).
		-->
		<script>
			(function () {
				try {
					const prefers = localStorage.getItem('frolf:prefers_dark');
					if (prefers === '1') {
						document.documentElement.classList.add('dark');
						return;
					}
					if (prefers === '0') {
						document.documentElement.classList.remove('dark');
						return;
					}

					const legacy = localStorage.getItem('theme');
					if (legacy === 'dark') {
						document.documentElement.classList.add('dark');
					} else if (legacy === 'light') {
						document.documentElement.classList.remove('dark');
					} else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
						document.documentElement.classList.add('dark');
					}
				} catch {
					// Ignore
				}
			})();
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="tap">
		<div class="svelte-root">%sveltekit.body%</div>
		<script>
			function updateMetaThemeColor() {
				try {
					const meta = document.querySelector('meta[name="theme-color"]');
					if (!meta) return;

					const rgb = getComputedStyle(document.documentElement)
						.getPropertyValue('--guild-primary-rgb')
						.trim();

					if (rgb) {
						meta.setAttribute('content', 'rgb(' + rgb + ')');
						return;
					}

					if (document.documentElement.classList.contains('dark')) {
						meta.setAttribute('content', '#0f0f0f');
					} else {
						meta.setAttribute('content', '#007474');
					}
				} catch {
					// Ignore.
				}
			}

			window.addEventListener('load', function () {
				updateMetaThemeColor();
				const observer = new MutationObserver(updateMetaThemeColor);
				observer.observe(document.documentElement, {
					attributes: true,
					attributeFilter: ['style', 'class']
				});
			});
		</script>
	</body>
</html>
